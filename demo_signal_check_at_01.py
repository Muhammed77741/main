"""
–î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–≥–Ω–∞–ª–∞ –Ω–∞ –∑–∞–∫—Ä—ã—Ç–æ–π —Å–≤–µ—á–µ –≤ 01:00

–≠—Ç–æ—Ç —Ç–µ—Å—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ—á–Ω–æ —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç, –∫–æ–≥–¥–∞ –±–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ 01:00
"""

from datetime import datetime

print("="*80)
print("–î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø: –ë–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ 01:00 –Ω–∞ —á–∞—Å–æ–≤–æ–º —Ç–∞–π–º—Ñ—Ä–µ–π–º–µ")
print("="*80)

# –°–∏–º—É–ª–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –±–æ—Ç –ø–æ–ª—É—á–∞–µ—Ç –æ—Ç MT5 –≤ 01:00
print("\nüìä –®–ê–ì 1: –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ –æ—Ç MT5")
print("-" * 60)

# –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏ —Å–≤–µ—á–µ–π (–∫–∞–∫ –≤ df.index)
bar_times = [
    datetime(2024, 1, 15, 22, 0),  # index -4: —Å–≤–µ—á–∞ 22:00-23:00
    datetime(2024, 1, 15, 23, 0),  # index -3: —Å–≤–µ—á–∞ 23:00-00:00
    datetime(2024, 1, 16, 0, 0),   # index -2: —Å–≤–µ—á–∞ 00:00-01:00 ‚Üê –ó–ê–ö–†–´–õ–ê–°–¨!
    datetime(2024, 1, 16, 1, 0),   # index -1: —Å–≤–µ—á–∞ 01:00-02:00 ‚Üê –¢–ï–ö–£–©–ê–Ø (–Ω–µ–∑–∞–∫—Ä—ã—Ç–∞—è)
]

print("–ü–æ–ª—É—á–µ–Ω–æ 4 —Å–≤–µ—á–∏:")
for i, t in enumerate(bar_times):
    idx = i - len(bar_times)  # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –∏–Ω–¥–µ–∫—Å
    if idx == -1:
        status = "‚Üê df.index[-1] –¢–ï–ö–£–©–ê–Ø (01:00-02:00) –ù–ï –ó–ê–ö–†–´–¢–ê"
    elif idx == -2:
        status = "‚Üê df.index[-2] –¢–û–õ–¨–ö–û –ß–¢–û –ó–ê–ö–†–´–õ–ê–°–¨ (00:00-01:00) ‚òÖ"
    else:
        status = ""
    print(f"  [{idx:2d}] {t.strftime('%Y-%m-%d %H:%M')} {status}")

# –°–∏–º—É–ª–∏—Ä—É–µ–º —á—Ç–æ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –Ω–∞—à–ª–∞ —Å–∏–≥–Ω–∞–ª –Ω–∞ –∑–∞–∫—Ä—ã—Ç–æ–π —Å–≤–µ—á–µ
print("\n\nüß† –®–ê–ì 2: –°—Ç—Ä–∞—Ç–µ–≥–∏—è –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –≤—Å–µ —Å–≤–µ—á–∏ –∏ –Ω–∞—Ö–æ–¥–∏—Ç —Å–∏–≥–Ω–∞–ª—ã")
print("-" * 60)

# –î–æ–ø—É—Å—Ç–∏–º —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –Ω–∞—à–ª–∞ —Å–∏–≥–Ω–∞–ª –Ω–∞ —Å–≤–µ—á–µ 00:00 (—Ç–æ–ª—å–∫–æ —á—Ç–æ –∑–∞–∫—Ä—ã—Ç–æ–π)
signal_bar_time = datetime(2024, 1, 16, 0, 0)  # –°–≤–µ—á–∞ 00:00-01:00

print(f"–°–∏–≥–Ω–∞–ª –Ω–∞–π–¥–µ–Ω –Ω–∞ —Å–≤–µ—á–µ: {signal_bar_time.strftime('%H:%M')}")
print(f"–≠—Ç–æ —Å–≤–µ—á–∞ 00:00-01:00 (—Ç–æ–ª—å–∫–æ —á—Ç–æ –∑–∞–∫—Ä—ã–ª–∞—Å—å –≤ 01:00)")

# –¢–µ–ø–µ—Ä—å –ø—Ä–∏–º–µ–Ω—è–µ–º –ª–æ–≥–∏–∫—É –±–æ—Ç–∞
print("\n\n‚úÖ –®–ê–ì 3: –ë–æ—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞ –∫–∞–∫–æ–π —Å–≤–µ—á–µ —Å–∏–≥–Ω–∞–ª")
print("-" * 60)

current_bar_time = bar_times[-1]  # df.index[-1] = 01:00
last_closed_bar_time = bar_times[-2]  # df.index[-2] = 00:00

print(f"–¢–µ–∫—É—â–∞—è —Å–≤–µ—á–∞ (df.index[-1]): {current_bar_time.strftime('%H:%M')} (–Ω–µ–∑–∞–∫—Ä—ã—Ç–∞—è)")
print(f"–ü–æ—Å–ª–µ–¥–Ω—è—è –∑–∞–∫—Ä—ã—Ç–∞—è (df.index[-2]): {last_closed_bar_time.strftime('%H:%M')}")
print()

# –ü—Ä–æ–≤–µ—Ä–∫–∞
print("–ü—Ä–æ–≤–µ—Ä–∫–∞: signal_bar_time == last_closed_bar_time?")
if signal_bar_time == last_closed_bar_time:
    print(f"‚úÖ –î–ê! –°–∏–≥–Ω–∞–ª –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞–∫—Ä—ã—Ç–æ–π —Å–≤–µ—á–µ!")
    print(f"   –í—Ä–µ–º—è —Å–∏–≥–Ω–∞–ª–∞: {signal_bar_time.strftime('%H:%M')}")
    print(f"   –ü–æ—Å–ª–µ–¥–Ω—è—è –∑–∞–∫—Ä—ã—Ç–∞—è: {last_closed_bar_time.strftime('%H:%M')}")
    print()
    print("üéØ –†–ï–ó–£–õ–¨–¢–ê–¢: –ë–æ—Ç –ò–°–ü–û–õ–¨–ó–£–ï–¢ —ç—Ç–æ—Ç —Å–∏–≥–Ω–∞–ª –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏!")
else:
    print(f"‚ùå –ù–ï–¢! –°–∏–≥–Ω–∞–ª –ù–ï –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞–∫—Ä—ã—Ç–æ–π —Å–≤–µ—á–µ")

# –¢–µ—Å—Ç–∏—Ä—É–µ–º –¥—Ä—É–≥–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
print("\n\n" + "="*80)
print("–î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –¢–ï–°–¢–´")
print("="*80)

# –¢–µ—Å—Ç 1: –°–∏–≥–Ω–∞–ª –Ω–∞ —Ç–µ–∫—É—â–µ–π (–Ω–µ–∑–∞–∫—Ä—ã—Ç–æ–π) —Å–≤–µ—á–µ
print("\n‚ùå –¢–µ—Å—Ç 1: –°–∏–≥–Ω–∞–ª –Ω–∞ –¢–ï–ö–£–©–ï–ô –Ω–µ–∑–∞–∫—Ä—ã—Ç–æ–π —Å–≤–µ—á–µ (01:00)")
print("-" * 60)
signal_current = datetime(2024, 1, 16, 1, 0)
print(f"–í—Ä–µ–º—è —Å–∏–≥–Ω–∞–ª–∞: {signal_current.strftime('%H:%M')}")
if signal_current == last_closed_bar_time:
    print("‚úÖ –°–∏–≥–Ω–∞–ª –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞–∫—Ä—ã—Ç–æ–π —Å–≤–µ—á–µ - –ò–°–ü–û–õ–¨–ó–£–ï–ú")
else:
    print("‚ùå –°–∏–≥–Ω–∞–ª –ù–ï –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞–∫—Ä—ã—Ç–æ–π —Å–≤–µ—á–µ - –ò–ì–ù–û–†–ò–†–£–ï–ú")
    print("   (–≠—Ç–æ —Ç–µ–∫—É—â–∞—è –Ω–µ–∑–∞–∫—Ä—ã—Ç–∞—è —Å–≤–µ—á–∞!)")

# –¢–µ—Å—Ç 2: –°–∏–≥–Ω–∞–ª –Ω–∞ —Å—Ç–∞—Ä–æ–π —Å–≤–µ—á–µ
print("\n‚ùå –¢–µ—Å—Ç 2: –°–∏–≥–Ω–∞–ª –Ω–∞ –°–¢–ê–†–û–ô —Å–≤–µ—á–µ (23:00)")
print("-" * 60)
signal_old = datetime(2024, 1, 15, 23, 0)
print(f"–í—Ä–µ–º—è —Å–∏–≥–Ω–∞–ª–∞: {signal_old.strftime('%H:%M')}")
if signal_old == last_closed_bar_time:
    print("‚úÖ –°–∏–≥–Ω–∞–ª –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞–∫—Ä—ã—Ç–æ–π —Å–≤–µ—á–µ - –ò–°–ü–û–õ–¨–ó–£–ï–ú")
else:
    print("‚ùå –°–∏–≥–Ω–∞–ª –ù–ï –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π –∑–∞–∫—Ä—ã—Ç–æ–π —Å–≤–µ—á–µ")
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç
    time_diff_hours = (current_bar_time - signal_old).total_seconds() / 3600
    print(f"   –í–æ–∑—Ä–∞—Å—Ç —Å–∏–≥–Ω–∞–ª–∞: {time_diff_hours:.1f} —á–∞—Å–æ–≤")
    if 0.5 <= time_diff_hours <= 1.5:
        print(f"   ‚ö†Ô∏è  –í –ø—Ä–µ–¥–µ–ª–∞—Ö 0.5-1.5 —á–∞—Å–æ–≤ - –ú–û–ñ–ï–ú –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å (–∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç)")
    else:
        print(f"   ‚ùå –°–ª–∏—à–∫–æ–º —Å—Ç–∞—Ä—ã–π (>{time_diff_hours:.1f}—á) - –ò–ì–ù–û–†–ò–†–£–ï–ú")

# –ò—Ç–æ–≥–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞
print("\n\n" + "="*80)
print("–ò–¢–û–ì–û–í–ê–Ø –¢–ê–ë–õ–ò–¶–ê: –ö–∞–∫–∏–µ —Å–∏–≥–Ω–∞–ª—ã –ø—Ä–∏–Ω–∏–º–∞—é—Ç—Å—è –≤ 01:00")
print("="*80)
print(f"""
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –í—Ä–µ–º—è –±–æ—Ç–∞: 01:00                                                       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ –°–≤–µ—á–∞          ‚îÇ –°—Ç–∞—Ç—É—Å           ‚îÇ –ü—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è?                        ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 22:00-23:00    ‚îÇ –°—Ç–∞—Ä–∞—è           ‚îÇ ‚ùå –ù–ï–¢ (—Å–ª–∏—à–∫–æ–º —Å—Ç–∞—Ä–∞—è)             ‚îÇ
‚îÇ 23:00-00:00    ‚îÇ –°—Ç–∞—Ä–∞—è           ‚îÇ ‚ùå –ù–ï–¢ (—Å–ª–∏—à–∫–æ–º —Å—Ç–∞—Ä–∞—è)             ‚îÇ
‚îÇ 00:00-01:00    ‚îÇ –ó–ê–ö–†–´–õ–ê–°–¨! ‚òÖ     ‚îÇ ‚úÖ –î–ê! (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)                  ‚îÇ
‚îÇ 01:00-02:00    ‚îÇ –¢–µ–∫—É—â–∞—è          ‚îÇ ‚ùå –ù–ï–¢ (–Ω–µ –∑–∞–∫—Ä—ã—Ç–∞)                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–õ–û–ì–ò–ö–ê:
1. ‚úÖ –°–ù–ê–ß–ê–õ–ê –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å–≤–µ—á—É 00:00-01:00 (df.index[-2])
   - –ï—Å–ª–∏ –µ—Å—Ç—å —Å–∏–≥–Ω–∞–ª ‚Üí –ò–°–ü–û–õ–¨–ó–£–ï–ú!
   
2. ‚ö†Ô∏è  –ï–°–õ–ò –ù–ï–¢ —Å–∏–≥–Ω–∞–ª–∞ –Ω–∞ —Å–≤–µ—á–µ 00:00-01:00:
   - –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥—Ä—É–≥–∏–µ —Å–≤–µ—á–∏ (–∑–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç)
   - –ü—Ä–∏–Ω–∏–º–∞–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ 0.5-1.5 —á–∞—Å–æ–≤ –Ω–∞–∑–∞–¥
   
3. ‚ùå –ù–ò–ö–û–ì–î–ê –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º:
   - –¢–µ–∫—É—â—É—é –Ω–µ–∑–∞–∫—Ä—ã—Ç—É—é —Å–≤–µ—á—É (01:00-02:00)
   - –°–ª–∏—à–∫–æ–º —Å—Ç–∞—Ä—ã–µ —Å–≤–µ—á–∏ (>1.5 —á–∞—Å–æ–≤)
""")
print("="*80)
