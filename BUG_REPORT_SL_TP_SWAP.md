# üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –û–®–ò–ë–ö–ê: Stop Loss –∏ Take Profit –ø–µ—Ä–µ–ø—É—Ç–∞–Ω—ã

## –ü—Ä–æ–±–ª–µ–º–∞

–í —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ `PatternRecognitionStrategy` (–∏ –≤—Å–µ—Ö —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –±—ç–∫—Ç–µ—Å—Ç–∞—Ö) –∑–Ω–∞—á–µ–Ω–∏—è **Stop Loss** –∏ **Take Profit** **–ø–µ—Ä–µ–ø—É—Ç–∞–Ω—ã –º–µ—Å—Ç–∞–º–∏** –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è.

### –ü—Ä–∏–º–µ—Ä—ã –∏–∑ –±—ç–∫—Ç–µ—Å—Ç–∞:

| –í—Ö–æ–¥ | –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ | SL (—Ñ–∞–∫—Ç) | SL (–¥–æ–ª–∂–µ–Ω) | TP (—Ñ–∞–∫—Ç) | TP (–¥–æ–ª–∂–µ–Ω) |
|------|-------------|-----------|-------------|-----------|-------------|
| 2625.58 | LONG | 2684.92 ‚ùå | ~2597 ‚úÖ | - | - |
| 2662.52 | LONG | **3195.37** ‚ùå | ~2627 ‚úÖ | 3524.68 | ~2720 |
| 2716.32 | LONG | **3710.88** ‚ùå | ~2680 ‚úÖ | - | - |

### –ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:

1. **SL –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –í–´–®–ï –≤—Ö–æ–¥–∞ –¥–ª—è LONG** (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ù–ò–ñ–ï)
2. –ü—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏ "SL" –ø–æ–∑–∏—Ü–∏—è –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å **–æ–≥—Ä–æ–º–Ω–æ–π –ø—Ä–∏–±—ã–ª—å—é** (400-1600 –ø—É–Ω–∫—Ç–æ–≤!)
3. P&L –∑–∞–≤—ã—à–µ–Ω: **+287%** –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
4. –ò–∑ 20 "–≤—ã–∏–≥—Ä—ã—à–µ–π" –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ - —ç—Ç–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ SL –≤ –ø—Ä–∏–±—ã–ª–∏
5. –°—Ä–µ–¥–Ω–∏–π "–≤—ã–∏–≥—Ä—ã—à": +14.66% (—ç—Ç–æ 400+ –ø—É–Ω–∫—Ç–æ–≤ –ø—Ä–∏–±—ã–ª–∏ –≤–º–µ—Å—Ç–æ —É–±—ã—Ç–∫–∞!)

## –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–≥–∞

### –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ ‚úÖ (–∫–æ–¥ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π):
- `SimplifiedSMCStrategy._calculate_stop_loss()` - –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç SL
- `Fibonacci1618Strategy._apply_fibonacci_tp()` - –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç TP
- `PatternRecognitionStrategy._add_pattern_signal()` - –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç sl/tp

### –ü–æ–¥–æ–∑—Ä–µ–≤–∞–µ–º—ã–µ —É—á–∞—Å—Ç–∫–∏ ‚ö†Ô∏è:
1. **`PatternRecognitionStrategy._detect_*_pattern()`** –º–µ—Ç–æ–¥—ã
   - –í–æ–∑–º–æ–∂–Ω–æ, –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ `pattern['support']` –∏–ª–∏ `pattern['resistance']`
   - –ú–æ–∂–µ—Ç –±—ã—Ç—å, –ø—É—Ç–∞—é—Ç swing_high –∏ swing_low

2. **–¶–µ–ø–æ—á–∫–∞ –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è:**
   ```
   PatternRecognitionStrategy 
   ‚Üí Fibonacci1618Strategy 
   ‚Üí IntradayGoldStrategy 
   ‚Üí GoldOptimizedSMCStrategy 
   ‚Üí SimplifiedSMCStrategy
   ```
   - –û–¥–∏–Ω –∏–∑ `run_strategy()` –º–µ—Ç–æ–¥–æ–≤ –º–æ–∂–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ

3. **GoldOptimizedSMCStrategy._adjust_gold_exits()**
   - –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç TP, –Ω–æ –º–æ–∂–µ—Ç —Å–ª—É—á–∞–π–Ω–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å SL

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç 1: –ú–∞–ª—ã–π dataset (–¥–æ 2025-01-08)
```
–†–µ–∑—É–ª—å—Ç–∞—Ç: ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û
Entry: 2625.58
SL: 2597.37 (–Ω–∏–∂–µ –≤—Ö–æ–¥–∞) ‚úÖ
TP: 2671.22 (–≤—ã—à–µ –≤—Ö–æ–¥–∞) ‚úÖ
```

### –¢–µ—Å—Ç 2: –ü–æ–ª–Ω—ã–π dataset (–≤–µ—Å—å 2025)
```
–†–µ–∑—É–ª—å—Ç–∞—Ç: ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û  
Entry: 2662.52
SL: 3195.37 (–≤—ã—à–µ –≤—Ö–æ–¥–∞ –Ω–∞ 532–ø!) ‚ùå
TP: 3524.68 ‚ùå
```

**–í—ã–≤–æ–¥:** –ë–∞–≥ –ø—Ä–æ—è–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–∏–≥–Ω–∞–ª–∞—Ö, –≤–µ—Ä–æ—è—Ç–Ω–æ –æ—Ç pattern detection.

## –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –±–∞–≥–∞

–î–ª—è —Å–∏–≥–Ω–∞–ª–∞ 2025-01-07 08:00:00:
```
Entry: 2662.52
SL (—Ñ–∞–∫—Ç): 3195.37
TP (—Ñ–∞–∫—Ç): 3524.68

–†–∞—Å—á–µ—Ç:
Risk = |3195.37 - 2662.52| = 532.85
TP = Entry + (Risk √ó 1.618) = 2662.52 + (532.85 √ó 1.618) = 3524.68 ‚úÖ

–ü—Ä–æ–±–ª–µ–º–∞: SL = 3195.37 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ "risk", 
–Ω–æ —ç—Ç–æ –Ω–∞ 532–ø –í–´–®–ï –≤—Ö–æ–¥–∞, –∞ –Ω–µ –Ω–∏–∂–µ!
```

–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å:
```
Entry: 2662.52  
SL (–¥–æ–ª–∂–µ–Ω): ~2627 (35–ø –Ω–∏–∂–µ)
Risk: 35
TP: 2662.52 + (35 √ó 1.618) = 2719.73
```

## –í–ª–∏—è–Ω–∏–µ –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –¢–µ–∫—É—â–∏–π (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π) –±—ç–∫—Ç–µ—Å—Ç:
- Total PnL: **+287.29%**
- Wins: 20 (62.5%)
- Avg Win: **+14.66%** (–±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ - –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ SL)
- Losses: 12 (37.5%)
- Avg Loss: -0.49%

### –†–µ–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (–æ—Ü–µ–Ω–∫–∞):
–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–≥–∞, —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –±—É–¥—É—Ç **–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —Ö—É–∂–µ**:
- –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ "–≤—ã–∏–≥—Ä—ã—à–µ–π" —Å—Ç–∞–Ω—É—Ç —É–±—ã—Ç–∫–∞–º–∏
- Win rate —É–ø–∞–¥—ë—Ç —Å 62.5% –¥–æ ~30-40%
- Total PnL –º–æ–∂–µ—Ç –±—ã—Ç—å **–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–º** –∏–ª–∏ –æ–∫–æ–ª–æ 0%

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### 1. –ù–∞–π—Ç–∏ —Ç–æ—á–Ω–æ–µ –º–µ—Å—Ç–æ –±–∞–≥–∞ ‚è≥
–ù—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤:
- `_detect_*_pattern()` –º–µ—Ç–æ–¥—ã
- `_add_pattern_signal()`
- `_apply_fibonacci_tp()`

### 2. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –±–∞–≥ üîß
–ü–æ—Å–ª–µ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏ - –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É —Ä–∞—Å—á–µ—Ç–∞ –∏–ª–∏ –ø—Ä–∏—Å–≤–æ–µ–Ω–∏—è SL/TP

### 3. –ü–µ—Ä–µ-–∑–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ –±—ç–∫—Ç–µ—Å—Ç—ã üîÑ
–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω—É–∂–Ω–æ –ø–µ—Ä–µ-—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:
- `backtest_v2_realistic.py`
- `backtest_v3_adaptive.py`
- `backtest_v3_fixed.py`
- –í—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –±—ç–∫—Ç–µ—Å—Ç—ã

### 4. –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é üìù
–û–±–Ω–æ–≤–∏—Ç—å:
- `BACKTEST_ANALYSIS_FULL.md`
- `BACKTEST_SUMMARY_RU.md`
- `BACKTEST_COMPARISON_V1_VS_V2.md`

## –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

–î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–∞–≥–∞ **–ù–ï –ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨**:
- ‚ùå `backtest_v2_realistic.py`
- ‚ùå `backtest_v3_adaptive.py`  
- ‚ùå `backtest_v3_fixed.py`
- ‚ùå `PatternRecognitionStrategy`

–ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:
- ‚úÖ `SimplifiedSMCStrategy` (–Ω–∞–ø—Ä—è–º—É—é, –±–µ–∑ Pattern Recognition)
- ‚úÖ –î—Ä—É–≥–∏–µ –±—ç–∫—Ç–µ—Å—Ç—ã –±–µ–∑ Pattern Recognition

---

**–°—Ç–∞—Ç—É—Å:** üî¥ **–ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô –ë–ê–ì** - —Ç—Ä–µ–±—É–µ—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è  
**–î–∞—Ç–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è:** 2026-01-06  
**–û–±–Ω–∞—Ä—É–∂–∏–ª:** copilot (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø–æ –∑–∞–ø—Ä–æ—Å—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
